import{q as L,e as H,f as oe,b as re,_ as ue,c as ie,u as pe,g as me,r as de,s as ce,j as _e,N as ge,k as fe,l as ve}from"./business-D5p9IAhh.js";import{d as V,aM as z,aN as J,a as Q,$ as l,p as he,r as be,al as Ne,o as x,c as $,w as t,f as a,g as B,t as M,h as e,b as A,s as I,F as q,v as X,aO as Y,B as F,be as ye,bf as ke,bg as K,K as Z,A as we,aT as C,N as W,aU as xe}from"./index-DVxvz-Q9.js";import{u as ee,a as ae,_ as Re,b as le}from"./form-Dgrrij6j.js";import{_ as ne}from"./Space-CiOp0hQH.js";import{_ as Se,a as Ue}from"./round-refresh-D324_5_p.js";import{a as Ge}from"./Grid-D5a-7oB5.js";const Pe=V({name:"UserOperateDrawer",__name:"user-operate-drawer",props:z({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:z(["submitted"],["update:visible"]),setup(b,{emit:P}){const N=b,k=P,f=J(b,"visible"),{formRef:R,validate:p,restoreValidation:S}=ee(),{defaultRequiredRule:U}=ae(),w=Q(()=>({add:l("page.manage.user.addUser"),edit:l("page.manage.user.editUser")})[N.operateType]),s=he(u());function u(){return{userName:"",userGender:null,nickName:"",userPhone:"",userEmail:"",userRoles:[],status:null}}const y={userName:U,status:U},c=be([]);async function G(){const{error:v,data:r}=await oe();if(!v){const h=r.map(n=>({label:n.roleName,value:n.roleCode})),d=s.userRoles.map(n=>({label:n,value:n}));c.value=[...d,...h]}}function D(){Object.assign(s,u()),N.operateType==="edit"&&N.rowData&&Object.assign(s,N.rowData)}function _(){f.value=!1}async function E(){var v;await p(),(v=window.$message)==null||v.success(l("common.updateSuccess")),_(),k("submitted")}return Ne(f,()=>{f.value&&(D(),S(),G())}),(v,r)=>{const h=X,d=Re,n=ue,i=re,m=Y,j=le,O=F,g=ne,te=ye,se=ke;return x(),$(se,{show:f.value,"onUpdate:show":r[7]||(r[7]=o=>f.value=o),"display-directive":"show",width:360},{default:t(()=>[a(te,{title:w.value,"native-scrollbar":!1,closable:""},{footer:t(()=>[a(g,{size:16},{default:t(()=>[a(O,{onClick:_},{default:t(()=>[B(M(e(l)("common.cancel")),1)]),_:1}),a(O,{type:"primary",onClick:E},{default:t(()=>[B(M(e(l)("common.confirm")),1)]),_:1})]),_:1})]),default:t(()=>[a(j,{ref_key:"formRef",ref:R,model:s,rules:y},{default:t(()=>[a(d,{label:e(l)("page.manage.user.userName"),path:"userName"},{default:t(()=>[a(h,{value:s.userName,"onUpdate:value":r[0]||(r[0]=o=>s.userName=o),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{label:e(l)("page.manage.user.userGender"),path:"userGender"},{default:t(()=>[a(i,{value:s.userGender,"onUpdate:value":r[1]||(r[1]=o=>s.userGender=o)},{default:t(()=>[(x(!0),A(q,null,I(e(L),o=>(x(),$(n,{key:o.value,value:o.value,label:e(l)(o.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(d,{label:e(l)("page.manage.user.nickName"),path:"nickName"},{default:t(()=>[a(h,{value:s.nickName,"onUpdate:value":r[2]||(r[2]=o=>s.nickName=o),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{label:e(l)("page.manage.user.userPhone"),path:"userPhone"},{default:t(()=>[a(h,{value:s.userPhone,"onUpdate:value":r[3]||(r[3]=o=>s.userPhone=o),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{label:e(l)("page.manage.user.userEmail"),path:"email"},{default:t(()=>[a(h,{value:s.userEmail,"onUpdate:value":r[4]||(r[4]=o=>s.userEmail=o),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(d,{label:e(l)("page.manage.user.userStatus"),path:"status"},{default:t(()=>[a(i,{value:s.status,"onUpdate:value":r[5]||(r[5]=o=>s.status=o)},{default:t(()=>[(x(!0),A(q,null,I(e(H),o=>(x(),$(n,{key:o.value,value:o.value,label:e(l)(o.label)},null,8,["value","label"]))),128))]),_:1},8,["value"])]),_:1},8,["label"]),a(d,{label:e(l)("page.manage.user.userRole"),path:"roles"},{default:t(()=>[a(m,{value:s.userRoles,"onUpdate:value":r[6]||(r[6]=o=>s.userRoles=o),multiple:"",options:c.value,placeholder:e(l)("page.manage.user.form.userRole")},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])]),_:1},8,["show"])}}}),De=V({name:"UserSearch",__name:"user-search",props:{model:{required:!0},modelModifiers:{}},emits:z(["reset","search"],["update:model"]),setup(b,{emit:P}){const N=P,{formRef:k,validate:f,restoreValidation:R}=ee(),p=J(b,"model"),S=Q(()=>{const{patternRules:s}=ae();return{userEmail:s.email,userPhone:s.phone}});async function U(){await R(),N("reset")}async function w(){await f(),N("search")}return(s,u)=>{const y=X,c=ie,G=Y,D=Se,_=F,E=Ue,v=ne,r=Ge,h=le,d=Z;return x(),$(d,{title:e(l)("common.search"),bordered:!1,size:"small",class:"card-wrapper"},{default:t(()=>[a(h,{ref_key:"formRef",ref:k,model:p.value,rules:S.value,"label-placement":"left","label-width":80},{default:t(()=>[a(r,{responsive:"screen","item-responsive":""},{default:t(()=>[a(c,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userName"),path:"userName",class:"pr-24px"},{default:t(()=>[a(y,{value:p.value.userName,"onUpdate:value":u[0]||(u[0]=n=>p.value.userName=n),placeholder:e(l)("page.manage.user.form.userName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userGender"),path:"userGender",class:"pr-24px"},{default:t(()=>[a(G,{value:p.value.userGender,"onUpdate:value":u[1]||(u[1]=n=>p.value.userGender=n),placeholder:e(l)("page.manage.user.form.userGender"),options:e(K)(e(L)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),a(c,{span:"24 s:12 m:6",label:e(l)("page.manage.user.nickName"),path:"nickName",class:"pr-24px"},{default:t(()=>[a(y,{value:p.value.nickName,"onUpdate:value":u[2]||(u[2]=n=>p.value.nickName=n),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userPhone"),path:"userPhone",class:"pr-24px"},{default:t(()=>[a(y,{value:p.value.userPhone,"onUpdate:value":u[3]||(u[3]=n=>p.value.userPhone=n),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userEmail"),path:"userEmail",class:"pr-24px"},{default:t(()=>[a(y,{value:p.value.userEmail,"onUpdate:value":u[4]||(u[4]=n=>p.value.userEmail=n),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(c,{span:"24 s:12 m:6",label:e(l)("page.manage.user.userStatus"),path:"userStatus",class:"pr-24px"},{default:t(()=>[a(G,{value:p.value.status,"onUpdate:value":u[5]||(u[5]=n=>p.value.status=n),placeholder:e(l)("page.manage.user.form.userStatus"),options:e(K)(e(H)),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),a(c,{span:"24 m:12",class:"pr-24px"},{default:t(()=>[a(v,{class:"w-full",justify:"end"},{default:t(()=>[a(_,{onClick:U},{icon:t(()=>[a(D,{class:"text-icon"})]),default:t(()=>[B(" "+M(e(l)("common.reset")),1)]),_:1}),a(_,{type:"primary",ghost:"",onClick:w},{icon:t(()=>[a(E,{class:"text-icon"})]),default:t(()=>[B(" "+M(e(l)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}}),Ee={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function T(b){return typeof b=="function"||Object.prototype.toString.call(b)==="[object Object]"&&!xe(b)}const Fe=V({name:"manage_user",__name:"index",setup(b){const P=we(),{columns:N,columnChecks:k,data:f,getData:R,getDataByPage:p,loading:S,mobilePagination:U,searchParams:w,resetSearchParams:s}=pe({apiFn:de,showTotal:!0,apiParams:{current:1,size:10,status:null,userName:null,userGender:null,nickName:null,userPhone:null,userEmail:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:l("common.index"),align:"center",width:64},{key:"userName",title:l("page.manage.user.userName"),align:"center",minWidth:100},{key:"userGender",title:l("page.manage.user.userGender"),align:"center",width:100,render:n=>{if(n.userGender===null)return null;const i={1:"primary",2:"error"},m=l(ce[n.userGender]);return a(W,{type:i[n.userGender]},T(m)?m:{default:()=>[m]})}},{key:"nickName",title:l("page.manage.user.nickName"),align:"center",minWidth:100},{key:"userPhone",title:l("page.manage.user.userPhone"),align:"center",width:120},{key:"userEmail",title:l("page.manage.user.userEmail"),align:"center",minWidth:200},{key:"status",title:l("page.manage.user.userStatus"),align:"center",width:100,render:n=>{if(n.status===null)return null;const i={1:"success",2:"warning"},m=l(_e[n.status]);return a(W,{type:i[n.status]},T(m)?m:{default:()=>[m]})}},{key:"operate",title:l("common.operate"),align:"center",width:130,render:n=>{let i;return a("div",{class:"flex-center gap-8px"},[a(F,{type:"primary",ghost:!0,size:"small",onClick:()=>d(n.id)},T(i=l("common.edit"))?i:{default:()=>[i]}),a(ge,{onPositiveClick:()=>h(n.id)},{default:()=>l("common.confirmDelete"),trigger:()=>{let m;return a(F,{type:"error",ghost:!0,size:"small"},T(m=l("common.delete"))?m:{default:()=>[m]})}})])}}]}),{drawerVisible:u,operateType:y,editingData:c,handleAdd:G,handleEdit:D,checkedRowKeys:_,onBatchDeleted:E,onDeleted:v}=me(f,R);async function r(){console.log(_.value),E()}function h(n){console.log(n),v()}function d(n){D(n)}return(n,i)=>{const m=fe,j=ve,O=Z;return x(),A("div",Ee,[a(De,{model:e(w),"onUpdate:model":i[0]||(i[0]=g=>C(w)?w.value=g:null),onReset:e(s),onSearch:e(p)},null,8,["model","onReset","onSearch"]),a(O,{title:e(l)("page.manage.user.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":t(()=>[a(m,{columns:e(k),"onUpdate:columns":i[1]||(i[1]=g=>C(k)?k.value=g:null),"disabled-delete":e(_).length===0,loading:e(S),onAdd:e(G),onDelete:r,onRefresh:e(R)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:t(()=>[a(j,{"checked-row-keys":e(_),"onUpdate:checkedRowKeys":i[2]||(i[2]=g=>C(_)?_.value=g:null),columns:e(N),data:e(f),size:"small","flex-height":!e(P).isMobile,"scroll-x":962,loading:e(S),remote:"","row-key":g=>g.id,pagination:e(U),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),a(Pe,{visible:e(u),"onUpdate:visible":i[3]||(i[3]=g=>C(u)?u.value=g:null),"operate-type":e(y),"row-data":e(c),onSubmitted:e(p)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{Fe as default};
